{% extends './base.html' %}
{% block main %}
    {% if error_message %} <div class="alert alert-warning" role="alert">{{ error_message}} </div>{% endif %}
  	<div class="col-lg-12">
		<form method="post" action="/instagram" class="input-group" id="url_submit">
            {% csrf_token %}
			<input type="text" class="form-control" name="url" placeholder="请在此粘贴正确的地址(https://www.instagram.com/gem0816/)">
			<span class="input-group-btn">
                <button class="btn btn-info" type="submit">确定</button>
            </span>
		</form>
	</div>
    <div class="userinfo-ads">
                <!--ads-->
                <div style="display:none; position: relative;">
          <iframe style="display:none;"></iframe>
                      <script type="text/javascript">
    var data = {
      placementid: '215525118939902_215526518939762',
      format: 'native',
      testmode: false,
      onAdLoaded: function(element) {
        console.log('Audience Network [215525118939902_215526518939762] ad loaded');
        element.style.display = 'block';
      },
      onAdError: function(errorCode, errorMessage) {
        console.log('Audience Network [215525118939902_215526518939762] error (' + errorCode + ') ' + errorMessage);
      }
    };
    (function(w,l,d,t){var a=t();var b=d.currentScript||(function(){var c=d.getElementsByTagName('script');return c[c.length-1];})();var e=b.parentElement;e.dataset.placementid=data.placementid;var f=function(v){try{return v.document.referrer;}catch(e){}return'';};var g=function(h){var i=h.indexOf('/',h.indexOf('://')+3);if(i===-1){return h;}return h.substring(0,i);};var j=[l.href];var k=false;var m=false;if(w!==w.parent){var n;var o=w;while(o!==n){var h;try{m=m||(o.$sf&&o.$sf.ext);h=o.location.href;}catch(e){k=true;}j.push(h||f(n));n=o;o=o.parent;}}var p=l.ancestorOrigins;if(p){if(p.length>0){data.domain=p[p.length-1];}else{data.domain=g(j[j.length-1]);}}data.url=j[j.length-1];data.channel=g(j[0]);data.width=screen.width;data.height=screen.height;data.pixelratio=w.devicePixelRatio;data.placementindex=w.ADNW&&w.ADNW.Ads?w.ADNW.Ads.length:0;data.crossdomain=k;data.safeframe=!!m;var q={};q.iframe=e.firstElementChild;var r='https://www.facebook.com/audiencenetwork/web/?sdk=5.3';for(var s in data){q[s]=data[s];if(typeof(data[s])!=='function'){r+='&'+s+'='+encodeURIComponent(data[s]);}}q.iframe.src=r;q.tagJsInitTime=a;q.rootElement=e;q.events=[];w.addEventListener('message',function(u){if(u.source!==q.iframe.contentWindow){return;}u.data.receivedTimestamp=t();if(this.sdkEventHandler){this.sdkEventHandler(u.data);}else{this.events.push(u.data);}}.bind(q),false);q.tagJsIframeAppendedTime=t();w.ADNW=w.ADNW||{};w.ADNW.Ads=w.ADNW.Ads||[];w.ADNW.Ads.push(q);w.ADNW.init&&w.ADNW.init(q);})(window,location,document,Date.now||function(){return+new Date;});
  </script>
  <script type="text/javascript" src="https://connect.facebook.net/en_US/fbadnw.js" async></script>
  <style>
   .thirdPartyRoot {
        background-color: white;
        color: #444;
        border: 1px solid #ccc;
        border-left: 0;
        border-right: 0;
        font-family: sans-serif;
        font-size: 14px;
        line-height: 16px;
        width: 320px;
        text-align: left;
        position: relative;
      }
      .thirdPartyMediaClass {
        width: 320px;
        height: 168px;
        margin: 12px 0;
      }
      .thirdPartySubtitleClass {
        font-size: 18px;
        -webkit-line-clamp: 1;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        height: 16px;
        -webkit-box-orient: vertical;
      }
      .thirdPartyTitleClass {
        padding-right: 12px;
        line-height: 18px;
        -webkit-line-clamp: 2;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        height: 36px;
        -webkit-box-orient: vertical;
      }
      .thirdPartyCallToActionClass {
        background-color: #416BC4;
        color: white;
        border-radius: 4px;
        padding: 6px 20px;
        float: right;
        text-align: center;
        text-transform: uppercase;
        font-size: 11px;
      }
      .fbDefaultNativeAdWrapper {
        font-size: 12px;
        line-height: 14px;
        margin: 12px 0;
        height: 36px;
        vertical-align: top;
      }
  </style>
          <div class="thirdPartyRoot">
          <a class="fbAdLink">
            <div class="fbAdMedia thirdPartyMediaClass"></div>
            <div class="fbAdSubtitle thirdPartySubtitleClass"></div>
            <div class="fbDefaultNativeAdWrapper">
              <div class="fbAdCallToAction thirdPartyCallToActionClass"></div>
              <div class="fbAdTitle thirdPartyTitleClass"></div>
            </div>
          </a>
        </div>
        </div>
            </div>
        </div>
    {# 帖子用户#}
    {% if url %}
        <div class="userinfo container"> {# 用户个人信息 #}
            <div class="userinfo-left">
                <img src="{{ url.userinfo.profile_pic_url }}" class="img">
            </div>
            <div class="userinfo-right">
                <p>{{ url.userinfo.username }}</p>
                &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;
                <p>{{ url.userinfo.full_name }}</p>
            </div>
        <div class="ins-content">
        {% if url.is_video %}
            <video src="{{ url.url }}" class="video" controls></video>
        {% else %}
            <img src="{{ url.url }}" class="img"/>
        {% endif %}
        </div>
        <div class="ad-instagram">
            <div class="ad-left"><a href="{{ url.url }}" class="btn btn-info big-button" download="{{ url.url }}">下载</a></div>
        </div>
        <blockquote>
            <ul>
                <li>图片或者视频加载需要时间，请耐心等候或者稍后刷新页面</li>
                <li>当前页面内容版权归 <a href="https://www.instagram.com/{{ url.userinfo.username }}" > @{{ url.userinfo.username }}</a>所有，本站只提供服务。</li>
            </ul>
        </blockquote>
        <div class="support-me">
        <p style='font-size:1.7em'>「赠人玫瑰，手有余香」</p>
        <a class="btn btn-danger support " href="/donate">打赏</a>
    </div>
    {% endif %}

    {# 个人用户 #}
    {% if urls %}
        <div class="userinfo"> {# 用户个人信息 #}
            <div class="userinfo-left">
                <img src="{{ userinfo.user.profile_picture }}" class="img">
            </div>
            <div class="userinfo-right">
                <p>{{ userinfo.user.username }}</p>
                &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;
                <p>{{ userinfo.user.full_name }}</p>
            </div>
            <div class="userinfo-ads">
                <div style="display:none; position: relative;">
          <iframe style="display:none;"></iframe>
                      <script type="text/javascript">
    var data = {
      placementid: '215525118939902_215526518939762',
      format: 'native',
      testmode: false,
      onAdLoaded: function(element) {
        console.log('Audience Network [215525118939902_215526518939762] ad loaded');
        element.style.display = 'block';
      },
      onAdError: function(errorCode, errorMessage) {
        console.log('Audience Network [215525118939902_215526518939762] error (' + errorCode + ') ' + errorMessage);
      }
    };
    (function(w,l,d,t){var a=t();var b=d.currentScript||(function(){var c=d.getElementsByTagName('script');return c[c.length-1];})();var e=b.parentElement;e.dataset.placementid=data.placementid;var f=function(v){try{return v.document.referrer;}catch(e){}return'';};var g=function(h){var i=h.indexOf('/',h.indexOf('://')+3);if(i===-1){return h;}return h.substring(0,i);};var j=[l.href];var k=false;var m=false;if(w!==w.parent){var n;var o=w;while(o!==n){var h;try{m=m||(o.$sf&&o.$sf.ext);h=o.location.href;}catch(e){k=true;}j.push(h||f(n));n=o;o=o.parent;}}var p=l.ancestorOrigins;if(p){if(p.length>0){data.domain=p[p.length-1];}else{data.domain=g(j[j.length-1]);}}data.url=j[j.length-1];data.channel=g(j[0]);data.width=screen.width;data.height=screen.height;data.pixelratio=w.devicePixelRatio;data.placementindex=w.ADNW&&w.ADNW.Ads?w.ADNW.Ads.length:0;data.crossdomain=k;data.safeframe=!!m;var q={};q.iframe=e.firstElementChild;var r='https://www.facebook.com/audiencenetwork/web/?sdk=5.3';for(var s in data){q[s]=data[s];if(typeof(data[s])!=='function'){r+='&'+s+'='+encodeURIComponent(data[s]);}}q.iframe.src=r;q.tagJsInitTime=a;q.rootElement=e;q.events=[];w.addEventListener('message',function(u){if(u.source!==q.iframe.contentWindow){return;}u.data.receivedTimestamp=t();if(this.sdkEventHandler){this.sdkEventHandler(u.data);}else{this.events.push(u.data);}}.bind(q),false);q.tagJsIframeAppendedTime=t();w.ADNW=w.ADNW||{};w.ADNW.Ads=w.ADNW.Ads||[];w.ADNW.Ads.push(q);w.ADNW.init&&w.ADNW.init(q);})(window,location,document,Date.now||function(){return+new Date;});
  </script>
  <script type="text/javascript" src="https://connect.facebook.net/en_US/fbadnw.js" async></script>
  <style>
   .thirdPartyRoot {
        background-color: white;
        color: #444;
        border: 1px solid #ccc;
        border-left: 0;
        border-right: 0;
        font-family: sans-serif;
        font-size: 14px;
        line-height: 16px;
        width: 320px;
        text-align: left;
        position: relative;
      }
      .thirdPartyMediaClass {
        width: 320px;
        height: 168px;
        margin: 12px 0;
      }
      .thirdPartySubtitleClass {
        font-size: 18px;
        -webkit-line-clamp: 1;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        height: 16px;
        -webkit-box-orient: vertical;
      }
      .thirdPartyTitleClass {
        padding-right: 12px;
        line-height: 18px;
        -webkit-line-clamp: 2;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        height: 36px;
        -webkit-box-orient: vertical;
      }
      .thirdPartyCallToActionClass {
        background-color: #416BC4;
        color: white;
        border-radius: 4px;
        padding: 6px 20px;
        float: right;
        text-align: center;
        text-transform: uppercase;
        font-size: 11px;
      }
      .fbDefaultNativeAdWrapper {
        font-size: 12px;
        line-height: 14px;
        margin: 12px 0;
        height: 36px;
        vertical-align: top;
      }
  </style>
          <div class="thirdPartyRoot">
          <a class="fbAdLink">
            <div class="fbAdMedia thirdPartyMediaClass"></div>
            <div class="fbAdSubtitle thirdPartySubtitleClass"></div>
            <div class="fbDefaultNativeAdWrapper">
              <div class="fbAdCallToAction thirdPartyCallToActionClass"></div>
              <div class="fbAdTitle thirdPartyTitleClass"></div>
            </div>
          </a>
        </div>
        </div>
            </div>
        </div>
        <div class="ins-content">
        {% for url in urls %}
            {% if '.jpg' in url %}
                <img src="{{ url }}" class="img_person img"/>
            {% else %}
                <video src="{{ url }}" class="video" controls></video>
            {% endif %}
            <div class="download"><a href="{{ url }}" class="btn btn-info big-button" download>下载</a></div>
        {% endfor %}
        {% if max_id %}
            <div class="ins-nextpage" style="text-align:center">
                <a href="/instagram/{{ max_id }}/{{ username }}/" class="btn btn-info">下一页</a>
            </div>
        {% endif %}
        </div>
        <blockquote>
            <ul>
                <li>当无法下载的时候，请使用Chrome浏览器或者360浏览器打开网站</li>
                <li>务必确保自己能正常访问<a href="https://www.instagram.com">Instagram.</a></li>
                <li>当前页面内容版权归 <a href="https://www.instagram.com/{{ userinfo.username }}" > @{{ userinfo.user.username }}</a>所有，本站只提供服务。</li>
            </ul>
        </blockquote>
        <div class="support-me">
        <p style='font-size:1.7em'>「赠人玫瑰，手有余香」</p>
        <a class="btn btn-danger support " href="/donate">打赏</a>
    </div>
    {% endif %}
    <div class="ads">
        <div style="display:none; position: relative;">
          <iframe style="display:none;"></iframe>
                      <script type="text/javascript">
    var data = {
      placementid: '215525118939902_215526518939762',
      format: 'native',
      testmode: false,
      onAdLoaded: function(element) {
        console.log('Audience Network [215525118939902_215526518939762] ad loaded');
        element.style.display = 'block';
      },
      onAdError: function(errorCode, errorMessage) {
        console.log('Audience Network [215525118939902_215526518939762] error (' + errorCode + ') ' + errorMessage);
      }
    };
    (function(w,l,d,t){var a=t();var b=d.currentScript||(function(){var c=d.getElementsByTagName('script');return c[c.length-1];})();var e=b.parentElement;e.dataset.placementid=data.placementid;var f=function(v){try{return v.document.referrer;}catch(e){}return'';};var g=function(h){var i=h.indexOf('/',h.indexOf('://')+3);if(i===-1){return h;}return h.substring(0,i);};var j=[l.href];var k=false;var m=false;if(w!==w.parent){var n;var o=w;while(o!==n){var h;try{m=m||(o.$sf&&o.$sf.ext);h=o.location.href;}catch(e){k=true;}j.push(h||f(n));n=o;o=o.parent;}}var p=l.ancestorOrigins;if(p){if(p.length>0){data.domain=p[p.length-1];}else{data.domain=g(j[j.length-1]);}}data.url=j[j.length-1];data.channel=g(j[0]);data.width=screen.width;data.height=screen.height;data.pixelratio=w.devicePixelRatio;data.placementindex=w.ADNW&&w.ADNW.Ads?w.ADNW.Ads.length:0;data.crossdomain=k;data.safeframe=!!m;var q={};q.iframe=e.firstElementChild;var r='https://www.facebook.com/audiencenetwork/web/?sdk=5.3';for(var s in data){q[s]=data[s];if(typeof(data[s])!=='function'){r+='&'+s+'='+encodeURIComponent(data[s]);}}q.iframe.src=r;q.tagJsInitTime=a;q.rootElement=e;q.events=[];w.addEventListener('message',function(u){if(u.source!==q.iframe.contentWindow){return;}u.data.receivedTimestamp=t();if(this.sdkEventHandler){this.sdkEventHandler(u.data);}else{this.events.push(u.data);}}.bind(q),false);q.tagJsIframeAppendedTime=t();w.ADNW=w.ADNW||{};w.ADNW.Ads=w.ADNW.Ads||[];w.ADNW.Ads.push(q);w.ADNW.init&&w.ADNW.init(q);})(window,location,document,Date.now||function(){return+new Date;});
  </script>
  <script type="text/javascript" src="https://connect.facebook.net/en_US/fbadnw.js" async></script>
  <style>
   .thirdPartyRoot {
        background-color: white;
        color: #444;
        border: 1px solid #ccc;
        border-left: 0;
        border-right: 0;
        font-family: sans-serif;
        font-size: 14px;
        line-height: 16px;
        width: 320px;
        text-align: left;
        position: relative;
      }
      .thirdPartyMediaClass {
        width: 320px;
        height: 168px;
        margin: 12px 0;
      }
      .thirdPartySubtitleClass {
        font-size: 18px;
        -webkit-line-clamp: 1;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        height: 16px;
        -webkit-box-orient: vertical;
      }
      .thirdPartyTitleClass {
        padding-right: 12px;
        line-height: 18px;
        -webkit-line-clamp: 2;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        height: 36px;
        -webkit-box-orient: vertical;
      }
      .thirdPartyCallToActionClass {
        background-color: #416BC4;
        color: white;
        border-radius: 4px;
        padding: 6px 20px;
        float: right;
        text-align: center;
        text-transform: uppercase;
        font-size: 11px;
      }
      .fbDefaultNativeAdWrapper {
        font-size: 12px;
        line-height: 14px;
        margin: 12px 0;
        height: 36px;
        vertical-align: top;
      }
  </style>
          <div class="thirdPartyRoot">
          <a class="fbAdLink">
            <div class="fbAdMedia thirdPartyMediaClass"></div>
            <div class="fbAdSubtitle thirdPartySubtitleClass"></div>
            <div class="fbDefaultNativeAdWrapper">
              <div class="fbAdCallToAction thirdPartyCallToActionClass"></div>
              <div class="fbAdTitle thirdPartyTitleClass"></div>
            </div>
          </a>
        </div>
        </div>
    </div>
    <footer>
        <ol class="breadcrumb">
            <li><a href="/">首页</a></li>
            <li><a href="/file">使用条款&amp;免责声明</a></li>
            <li><a href="Mailto:xypfdwy@163.com">联系我们</a></li>
            <li><span>Copyright &copy;2017-至今 保留所有权利.</span></li>
        </ol>
    </footer>
{% endblock %}